
## General enumeration
### General info
```bash
# Get Header values
curl -i http://$ip -v
``` 

For technologies: Use `Wappalyzer`
For potential useful info: `View-Source` (Ctrl+u)

### Directories bruteforce

- Smaller wordlists better at the beggining
	In Kali: `/usr/share/seclists/Discovery/Web-Content/raft-small-words.txt`

```bash
# Gobuster 
## Optional: -x followed by the technology (php, html, txt, aspx, ...)
gobuster dir -u http://$ip -w /wordlist -o dirs.root [-x ...]

# Wfuzz
wfuzz -c -w /wordlist --hc 404 http://$ip/FUZZ

# Feroxbuster: recursive scanning (avoid as much as possible because many requests)
feroxbuster -u http://$ip -w /wordlist -o dirs.root
```

#### Find hidden notes, readme, changelog 
```bash
gobuster dir -u http://$ip -w /wordlist -o gobust_txt.root -x txt
``` 

#### Files to browse manually 
```bash
/robots.txt 
/sitemap.xml
# Make it throw an error 
/doesnotexist 
``` 


### Find VHOSTS

#### wfuzz
```bash
wfuzz -c -w [WORDLIST] -u [URL] -H "Host: FUZZ.[URL]" -f [OUTFILE] --hs 302
```

## Web application specific:

### WordPress:

```bash
# Vulnerability scan (plugins, themes and users)
wpscan --url http://$ip -e p,t,u --detection-mode aggressive > wpscan.log

# Bruteforce login
wpscan --url http://$ip --passwords passwords.txt --usernames users.txt
```

#### Useful paths
```bash
# Configuration files
http://$ip/.htaccess
http://$ip/wp-config.php

# Directory listing
http://$ip/wp-includes
```

### Drupal, found here 
```bash
droopescan scan drupal http://$ip -t 32
```


## Common vulnerabilities

### LFI

Also look at [HackTricks](https://book.hacktricks.xyz/pentesting-web/file-inclusion)

```bash
# wfuzz
wfuzz -c -w ./wordlist.txt --hw 0 http://$ip/vulnerable.php?page=../../../../../../../FUZZ
```

Tips (For Windows and Linux):
- Change `/` for `\` 
- Add `../../../../../`
### Bruteforce valid users through Login form

If login form returns different output for valid and invalid users, you can use **WFUZZ** to bruteforce users:
```bash
wfuzz -c -z file,/usr/share/seclists/Usernames/Names/names.txt --hw 311 -d "user=FUZZ&password=anything" -f users.txt http://example/login.php
```
Make sure to change `--hw 311` by the ammount of words in the response corresponding to an invalid user.



### SSTI

Test using this string (crash = good):
```
${{<%[%'"}}%\.
```
